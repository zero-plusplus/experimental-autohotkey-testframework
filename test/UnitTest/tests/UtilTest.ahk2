#Include ..\common.ahk2

class UtilTest {
  testEquals(assert) {
    assert.ok(UnitTest.Util.equals("abc", "abc"))
    assert.notOk(UnitTest.Util.equals("abc", "Abc"))
  }
  testEqualsIgnoreCase(assert) {
    assert.ok(UnitTest.Util.equalsIgnoreCase("abc", "abc"))
    assert.ok(UnitTest.Util.equalsIgnoreCase("abc", "ABC"))
  }
  testIsNamedFunc(assert) {
    assert.ok(UnitTest.Util.isNamedFunc(this.testIsNamedFunc))
  }
  testRepeatStr(assert) {
    assert.equals(UnitTest.Util.repeatStr("a", 3), "aaa")
  }
  testSplitLines(assert) {
    assert.ok(UnitTest.Util.splitLines("a`nb`nc") is Array)
    assert.equals(UnitTest.Util.splitLines("a`nb`nc").length, 3)
    assert.equals(UnitTest.Util.splitLines("a`r`nb`r`nc").length, 3)
  }
  testGetProp(assert) {
    assert.equals(UnitTest.Util.getProp({ key: "value" }, "key"), "value")
    assert.equals(UnitTest.Util.getProp(Map("key", "value"), "key"), "value")
    assert.equals(UnitTest.Util.getProp([ "value" ], 1), "value")
  }
  testTryGetProp(assert) {
    assert.equals(UnitTest.Util.tryGetProp({ key: "value" }, "unknown", "default"), "default")
  }
}